services:
  # Service web pour l'application Flask
  - type: web
    name: ecommerce-flask-app
    env: python
    region: frankfurt  # ou oregon, singapore, etc.
    plan: free
    buildCommand: "pip install --upgrade pip && pip install -e ."
    startCommand: "python run.py production"
    envVars:
      - key: FLASK_CONFIG
        value: production
      - key: SECRET_KEY
        generateValue: true
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: DATABASE_URL
        fromDatabase:
          name: ecommerce-postgres-db
          property: connectionString
    
  # Base de donn√©es PostgreSQL
  - type: pserv
    name: ecommerce-postgres-db
    env: docker
    plan: free
    image:
      name: postgres
      tag: '15'
    disk:
      name: ecommerce-data
      mountPath: /var/lib/postgresql/data
      sizeGB: 1
